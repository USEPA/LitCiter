{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///./src/taskpane/base64.js?","webpack:///webpack/bootstrap?","webpack:///webpack/runtime/compat get default export?","webpack:///webpack/runtime/define property getters?","webpack:///webpack/runtime/global?","webpack:///webpack/runtime/hasOwnProperty shorthand?","webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["//\r\n// THIS FILE IS AUTOMATICALLY GENERATED! DO NOT EDIT BY HAND!\r\n//\r\n(function (global, factory) {\r\n  typeof exports === \"object\" && typeof module !== \"undefined\"\r\n    ? (module.exports = factory())\r\n    : typeof define === \"function\" && define.amd\r\n    ? define(factory)\r\n    : // cf. https://github.com/dankogai/js-base64/issues/119\r\n      (function () {\r\n        // existing version for noConflict()\r\n        var _Base64 = global.Base64;\r\n        var gBase64 = factory();\r\n        gBase64.noConflict = function () {\r\n          global.Base64 = _Base64;\r\n          return gBase64;\r\n        };\r\n        if (global.Meteor) {\r\n          // Meteor.js\r\n          Base64 = gBase64;\r\n        }\r\n        global.Base64 = gBase64;\r\n      })();\r\n})(\r\n  typeof self !== \"undefined\"\r\n    ? self\r\n    : typeof window !== \"undefined\"\r\n    ? window\r\n    : typeof global !== \"undefined\"\r\n    ? global\r\n    : this,\r\n  function () {\r\n    \"use strict\";\r\n    /**\r\n     *  base64.ts\r\n     *\r\n     *  Licensed under the BSD 3-Clause License.\r\n     *    http://opensource.org/licenses/BSD-3-Clause\r\n     *\r\n     *  References:\r\n     *    http://en.wikipedia.org/wiki/Base64\r\n     *\r\n     * @author Dan Kogai (https://github.com/dankogai)\r\n     */\r\n    var version = \"3.7.2\";\r\n    /**\r\n     * @deprecated use lowercase `version`.\r\n     */\r\n    var VERSION = version;\r\n    var _hasatob = typeof atob === \"function\";\r\n    var _hasbtoa = typeof btoa === \"function\";\r\n    var _hasBuffer = typeof Buffer === \"function\";\r\n    var _TD = typeof TextDecoder === \"function\" ? new TextDecoder() : undefined;\r\n    var _TE = typeof TextEncoder === \"function\" ? new TextEncoder() : undefined;\r\n    var b64ch = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\r\n    var b64chs = Array.prototype.slice.call(b64ch);\r\n    var b64tab = (function (a) {\r\n      var tab = {};\r\n      a.forEach(function (c, i) {\r\n        return (tab[c] = i);\r\n      });\r\n      return tab;\r\n    })(b64chs);\r\n    var b64re = /^(?:[A-Za-z\\d+\\/]{4})*?(?:[A-Za-z\\d+\\/]{2}(?:==)?|[A-Za-z\\d+\\/]{3}=?)?$/;\r\n    var _fromCC = String.fromCharCode.bind(String);\r\n    var _U8Afrom =\r\n      typeof Uint8Array.from === \"function\"\r\n        ? Uint8Array.from.bind(Uint8Array)\r\n        : function (it, fn) {\r\n            if (fn === void 0) {\r\n              fn = function (x) {\r\n                return x;\r\n              };\r\n            }\r\n            return new Uint8Array(Array.prototype.slice.call(it, 0).map(fn));\r\n          };\r\n    var _mkUriSafe = function (src) {\r\n      return src.replace(/=/g, \"\").replace(/[+\\/]/g, function (m0) {\r\n        return m0 == \"+\" ? \"-\" : \"_\";\r\n      });\r\n    };\r\n    var _tidyB64 = function (s) {\r\n      return s.replace(/[^A-Za-z0-9\\+\\/]/g, \"\");\r\n    };\r\n    /**\r\n     * polyfill version of `btoa`\r\n     */\r\n    var btoaPolyfill = function (bin) {\r\n      // console.log('polyfilled');\r\n      var u32,\r\n        c0,\r\n        c1,\r\n        c2,\r\n        asc = \"\";\r\n      var pad = bin.length % 3;\r\n      for (var i = 0; i < bin.length; ) {\r\n        if ((c0 = bin.charCodeAt(i++)) > 255 || (c1 = bin.charCodeAt(i++)) > 255 || (c2 = bin.charCodeAt(i++)) > 255)\r\n          throw new TypeError(\"invalid character found\");\r\n        u32 = (c0 << 16) | (c1 << 8) | c2;\r\n        asc += b64chs[(u32 >> 18) & 63] + b64chs[(u32 >> 12) & 63] + b64chs[(u32 >> 6) & 63] + b64chs[u32 & 63];\r\n      }\r\n      return pad ? asc.slice(0, pad - 3) + \"===\".substring(pad) : asc;\r\n    };\r\n    /**\r\n     * does what `window.btoa` of web browsers do.\r\n     * @param {String} bin binary string\r\n     * @returns {string} Base64-encoded string\r\n     */\r\n    var _btoa = _hasbtoa\r\n      ? function (bin) {\r\n          return btoa(bin);\r\n        }\r\n      : _hasBuffer\r\n      ? function (bin) {\r\n          return Buffer.from(bin, \"binary\").toString(\"base64\");\r\n        }\r\n      : btoaPolyfill;\r\n    var _fromUint8Array = _hasBuffer\r\n      ? function (u8a) {\r\n          return Buffer.from(u8a).toString(\"base64\");\r\n        }\r\n      : function (u8a) {\r\n          // cf. https://stackoverflow.com/questions/12710001/how-to-convert-uint8-array-to-base64-encoded-string/12713326#12713326\r\n          var maxargs = 0x1000;\r\n          var strs = [];\r\n          for (var i = 0, l = u8a.length; i < l; i += maxargs) {\r\n            strs.push(_fromCC.apply(null, u8a.subarray(i, i + maxargs)));\r\n          }\r\n          return _btoa(strs.join(\"\"));\r\n        };\r\n    /**\r\n     * converts a Uint8Array to a Base64 string.\r\n     * @param {boolean} [urlsafe] URL-and-filename-safe a la RFC4648 §5\r\n     * @returns {string} Base64 string\r\n     */\r\n    var fromUint8Array = function (u8a, urlsafe) {\r\n      if (urlsafe === void 0) {\r\n        urlsafe = false;\r\n      }\r\n      return urlsafe ? _mkUriSafe(_fromUint8Array(u8a)) : _fromUint8Array(u8a);\r\n    };\r\n    // This trick is found broken https://github.com/dankogai/js-base64/issues/130\r\n    // const utob = (src: string) => unescape(encodeURIComponent(src));\r\n    // reverting good old fationed regexp\r\n    var cb_utob = function (c) {\r\n      if (c.length < 2) {\r\n        var cc = c.charCodeAt(0);\r\n        return cc < 0x80\r\n          ? c\r\n          : cc < 0x800\r\n          ? _fromCC(0xc0 | (cc >>> 6)) + _fromCC(0x80 | (cc & 0x3f))\r\n          : _fromCC(0xe0 | ((cc >>> 12) & 0x0f)) + _fromCC(0x80 | ((cc >>> 6) & 0x3f)) + _fromCC(0x80 | (cc & 0x3f));\r\n      } else {\r\n        var cc = 0x10000 + (c.charCodeAt(0) - 0xd800) * 0x400 + (c.charCodeAt(1) - 0xdc00);\r\n        return (\r\n          _fromCC(0xf0 | ((cc >>> 18) & 0x07)) +\r\n          _fromCC(0x80 | ((cc >>> 12) & 0x3f)) +\r\n          _fromCC(0x80 | ((cc >>> 6) & 0x3f)) +\r\n          _fromCC(0x80 | (cc & 0x3f))\r\n        );\r\n      }\r\n    };\r\n    var re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\r\n    /**\r\n     * @deprecated should have been internal use only.\r\n     * @param {string} src UTF-8 string\r\n     * @returns {string} UTF-16 string\r\n     */\r\n    var utob = function (u) {\r\n      return u.replace(re_utob, cb_utob);\r\n    };\r\n    //\r\n    var _encode = _hasBuffer\r\n      ? function (s) {\r\n          return Buffer.from(s, \"utf8\").toString(\"base64\");\r\n        }\r\n      : _TE\r\n      ? function (s) {\r\n          return _fromUint8Array(_TE.encode(s));\r\n        }\r\n      : function (s) {\r\n          return _btoa(utob(s));\r\n        };\r\n    /**\r\n     * converts a UTF-8-encoded string to a Base64 string.\r\n     * @param {boolean} [urlsafe] if `true` make the result URL-safe\r\n     * @returns {string} Base64 string\r\n     */\r\n    var encode = function (src, urlsafe) {\r\n      if (urlsafe === void 0) {\r\n        urlsafe = false;\r\n      }\r\n      return urlsafe ? _mkUriSafe(_encode(src)) : _encode(src);\r\n    };\r\n    /**\r\n     * converts a UTF-8-encoded string to URL-safe Base64 RFC4648 §5.\r\n     * @returns {string} Base64 string\r\n     */\r\n    var encodeURI = function (src) {\r\n      return encode(src, true);\r\n    };\r\n    // This trick is found broken https://github.com/dankogai/js-base64/issues/130\r\n    // const btou = (src: string) => decodeURIComponent(escape(src));\r\n    // reverting good old fationed regexp\r\n    var re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\r\n    var cb_btou = function (cccc) {\r\n      switch (cccc.length) {\r\n        case 4:\r\n          var cp =\r\n              ((0x07 & cccc.charCodeAt(0)) << 18) |\r\n              ((0x3f & cccc.charCodeAt(1)) << 12) |\r\n              ((0x3f & cccc.charCodeAt(2)) << 6) |\r\n              (0x3f & cccc.charCodeAt(3)),\r\n            offset = cp - 0x10000;\r\n          return _fromCC((offset >>> 10) + 0xd800) + _fromCC((offset & 0x3ff) + 0xdc00);\r\n        case 3:\r\n          return _fromCC(\r\n            ((0x0f & cccc.charCodeAt(0)) << 12) | ((0x3f & cccc.charCodeAt(1)) << 6) | (0x3f & cccc.charCodeAt(2))\r\n          );\r\n        default:\r\n          return _fromCC(((0x1f & cccc.charCodeAt(0)) << 6) | (0x3f & cccc.charCodeAt(1)));\r\n      }\r\n    };\r\n    /**\r\n     * @deprecated should have been internal use only.\r\n     * @param {string} src UTF-16 string\r\n     * @returns {string} UTF-8 string\r\n     */\r\n    var btou = function (b) {\r\n      return b.replace(re_btou, cb_btou);\r\n    };\r\n    /**\r\n     * polyfill version of `atob`\r\n     */\r\n    var atobPolyfill = function (asc) {\r\n      // console.log('polyfilled');\r\n      asc = asc.replace(/\\s+/g, \"\");\r\n      if (!b64re.test(asc)) throw new TypeError(\"malformed base64.\");\r\n      asc += \"==\".slice(2 - (asc.length & 3));\r\n      var u24,\r\n        bin = \"\",\r\n        r1,\r\n        r2;\r\n      for (var i = 0; i < asc.length; ) {\r\n        u24 =\r\n          (b64tab[asc.charAt(i++)] << 18) |\r\n          (b64tab[asc.charAt(i++)] << 12) |\r\n          ((r1 = b64tab[asc.charAt(i++)]) << 6) |\r\n          (r2 = b64tab[asc.charAt(i++)]);\r\n        bin +=\r\n          r1 === 64\r\n            ? _fromCC((u24 >> 16) & 255)\r\n            : r2 === 64\r\n            ? _fromCC((u24 >> 16) & 255, (u24 >> 8) & 255)\r\n            : _fromCC((u24 >> 16) & 255, (u24 >> 8) & 255, u24 & 255);\r\n      }\r\n      return bin;\r\n    };\r\n    /**\r\n     * does what `window.atob` of web browsers do.\r\n     * @param {String} asc Base64-encoded string\r\n     * @returns {string} binary string\r\n     */\r\n    var _atob = _hasatob\r\n      ? function (asc) {\r\n          return atob(_tidyB64(asc));\r\n        }\r\n      : _hasBuffer\r\n      ? function (asc) {\r\n          return Buffer.from(asc, \"base64\").toString(\"binary\");\r\n        }\r\n      : atobPolyfill;\r\n    //\r\n    var _toUint8Array = _hasBuffer\r\n      ? function (a) {\r\n          return _U8Afrom(Buffer.from(a, \"base64\"));\r\n        }\r\n      : function (a) {\r\n          return _U8Afrom(_atob(a), function (c) {\r\n            return c.charCodeAt(0);\r\n          });\r\n        };\r\n    /**\r\n     * converts a Base64 string to a Uint8Array.\r\n     */\r\n    var toUint8Array = function (a) {\r\n      return _toUint8Array(_unURI(a));\r\n    };\r\n    //\r\n    var _decode = _hasBuffer\r\n      ? function (a) {\r\n          return Buffer.from(a, \"base64\").toString(\"utf8\");\r\n        }\r\n      : _TD\r\n      ? function (a) {\r\n          return _TD.decode(_toUint8Array(a));\r\n        }\r\n      : function (a) {\r\n          return btou(_atob(a));\r\n        };\r\n    var _unURI = function (a) {\r\n      return _tidyB64(\r\n        a.replace(/[-_]/g, function (m0) {\r\n          return m0 == \"-\" ? \"+\" : \"/\";\r\n        })\r\n      );\r\n    };\r\n    /**\r\n     * converts a Base64 string to a UTF-8 string.\r\n     * @param {String} src Base64 string.  Both normal and URL-safe are supported\r\n     * @returns {string} UTF-8 string\r\n     */\r\n    var decode = function (src) {\r\n      return _decode(_unURI(src));\r\n    };\r\n    /**\r\n     * check if a value is a valid Base64 string\r\n     * @param {String} src a value to check\r\n     */\r\n    var isValid = function (src) {\r\n      if (typeof src !== \"string\") return false;\r\n      var s = src.replace(/\\s+/g, \"\").replace(/={0,2}$/, \"\");\r\n      return !/[^\\s0-9a-zA-Z\\+/]/.test(s) || !/[^\\s0-9a-zA-Z\\-_]/.test(s);\r\n    };\r\n    //\r\n    var _noEnum = function (v) {\r\n      return {\r\n        value: v,\r\n        enumerable: false,\r\n        writable: true,\r\n        configurable: true,\r\n      };\r\n    };\r\n    /**\r\n     * extend String.prototype with relevant methods\r\n     */\r\n    var extendString = function () {\r\n      var _add = function (name, body) {\r\n        return Object.defineProperty(String.prototype, name, _noEnum(body));\r\n      };\r\n      _add(\"fromBase64\", function () {\r\n        return decode(this);\r\n      });\r\n      _add(\"toBase64\", function (urlsafe) {\r\n        return encode(this, urlsafe);\r\n      });\r\n      _add(\"toBase64URI\", function () {\r\n        return encode(this, true);\r\n      });\r\n      _add(\"toBase64URL\", function () {\r\n        return encode(this, true);\r\n      });\r\n      _add(\"toUint8Array\", function () {\r\n        return toUint8Array(this);\r\n      });\r\n    };\r\n    /**\r\n     * extend Uint8Array.prototype with relevant methods\r\n     */\r\n    var extendUint8Array = function () {\r\n      var _add = function (name, body) {\r\n        return Object.defineProperty(Uint8Array.prototype, name, _noEnum(body));\r\n      };\r\n      _add(\"toBase64\", function (urlsafe) {\r\n        return fromUint8Array(this, urlsafe);\r\n      });\r\n      _add(\"toBase64URI\", function () {\r\n        return fromUint8Array(this, true);\r\n      });\r\n      _add(\"toBase64URL\", function () {\r\n        return fromUint8Array(this, true);\r\n      });\r\n    };\r\n    /**\r\n     * extend Builtin prototypes with relevant methods\r\n     */\r\n    var extendBuiltins = function () {\r\n      extendString();\r\n      extendUint8Array();\r\n    };\r\n    var gBase64 = {\r\n      version: version,\r\n      VERSION: VERSION,\r\n      atob: _atob,\r\n      atobPolyfill: atobPolyfill,\r\n      btoa: _btoa,\r\n      btoaPolyfill: btoaPolyfill,\r\n      fromBase64: decode,\r\n      toBase64: encode,\r\n      encode: encode,\r\n      encodeURI: encodeURI,\r\n      encodeURL: encodeURI,\r\n      utob: utob,\r\n      btou: btou,\r\n      decode: decode,\r\n      isValid: isValid,\r\n      fromUint8Array: fromUint8Array,\r\n      toUint8Array: toUint8Array,\r\n      extendString: extendString,\r\n      extendUint8Array: extendUint8Array,\r\n      extendBuiltins: extendBuiltins,\r\n    };\r\n    //\r\n    // export Base64 to the namespace\r\n    //\r\n    // ES5 is yet to have Object.assign() that may make transpilers unhappy.\r\n    // gBase64.Base64 = Object.assign({}, gBase64);\r\n    gBase64.Base64 = {};\r\n    Object.keys(gBase64).forEach(function (k) {\r\n      return (gBase64.Base64[k] = gBase64[k]);\r\n    });\r\n    return gBase64;\r\n  }\r\n);\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n/* global document, Office, OfficeExtension, Word, DOMParser */\r\n\r\nimport { Base64 } from \"./base64.js\";\r\n\r\nOffice.onReady((info) => {\r\n  if (info.host === Office.HostType.Word) {\r\n    // Determine if the user's version of Office supports all the Office.js APIs that are used in the tutorial.\r\n    if (!Office.context.requirements.isSetSupported(\"WordApi\", \"1.3\")) {\r\n      document.getElementById(\"error-box\").innerHTML +=\r\n        \"Sorry. The tutorial add-in uses Word.js APIs that are not available in your version of Office.<br/>\";\r\n    }\r\n\r\n    // enable extended logging\r\n    OfficeExtension.config.extendedErrorLogging = true;\r\n\r\n    // Assign event handlers and other initialization logic.\r\n    document.getElementById(\"link-hero\").onclick = function () {\r\n      changeCitations(\"hero\");\r\n    };\r\n    document.getElementById(\"link-heronet\").onclick = function () {\r\n      changeCitations(\"heronet\");\r\n    };\r\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\r\n    document.getElementById(\"app-body\").style.display = \"flex\";\r\n    document.getElementById(\"progress-text\").innerHTML = \"Initializing...\";\r\n  }\r\n});\r\n\r\nfunction getURL(url, label) {\r\n  var newURL;\r\n  if (url == \"hero\") {\r\n    newURL = \"https://hero.epa.gov/hero/index.cfm/reference/details/reference_id/\" + label;\r\n  }\r\n  if (url == \"heronet\") {\r\n    newURL = \"http://heronet.epa.gov/heronet/index.cfm/reference/details/reference_id/\" + label;\r\n  }\r\n  return newURL;\r\n}\r\n\r\nfunction changeURL(url, oldURL) {\r\n  var newURL;\r\n  var heroURL = \"https://hero.epa.gov/hero/index.cfm/reference/details/reference_id/\";\r\n  var heroNetURL = \"http://heronet.epa.gov/heronet/index.cfm/reference/details/reference_id/\";\r\n  if (!oldURL.includes(heroURL) && !oldURL.includes(heroNetURL)) {\r\n    return null;\r\n  }\r\n  if (url == \"hero\") {\r\n    newURL = oldURL.replace(heroNetURL, heroURL);\r\n  }\r\n  if (url == \"heronet\") {\r\n    newURL = oldURL.replace(heroURL, heroNetURL);\r\n  }\r\n  return newURL;\r\n}\r\n\r\nfunction changeCitations(url) {\r\n  Word.run(function (context) {\r\n    /*\r\n        todo:\r\n        remove check for en.cite.data for decoding\r\n            order doesn't matter, just try and decode all of the fields w/ check\r\n        count uses of each citation in block 2?\r\n            no point in this\r\n        add version number\r\n        change format of bib links\r\n        move to async?\r\n        \r\n        things to fix:\r\n            linebreak with issn\r\n            < and > in doi link\r\n            for id 77963, no space after link\r\n\r\n        var docBody = context.document.body;\r\n        docBody.insertParagraph(\"\" + decoded,\r\n                                \"End\");\r\n\r\n        */\r\n\r\n    // clear error box\r\n    document.getElementById(\"error-box\").innerHTML = '<p style=\"\">Errors and Warnings</p>';\r\n    document.getElementById(\"loader\").style.display = \"flex\";\r\n    document.getElementById(\"app-body\").style.display = \"none\";\r\n    document.getElementById(\"progress-text\").innerHTML = \"Changing links...\";\r\n\r\n    var body = context.document.body;\r\n    var bodyOoxml = body.getOoxml();\r\n    var linkRanges = body.getRange(\"Content\").getHyperlinkRanges();\r\n    linkRanges.load(\"items, hyperlink, font, text\");\r\n\r\n    var oParser = new DOMParser();\r\n    var bibSearch;\r\n    var bibSearch2;\r\n    var bibSearch3;\r\n    var citationList;\r\n    var citationMatching;\r\n    var bookmarkList;\r\n    var oldBodyXML;\r\n\r\n    return context\r\n      .sync()\r\n      .then(function () {\r\n        // search xml to get citations\r\n        var xmlDOM = oParser.parseFromString(bodyOoxml.value, \"text/xml\");\r\n        citationList = getCitationList(context, xmlDOM); // returns array of citation objects\r\n        bookmarkList = getBibCitations(context, xmlDOM); // returns object with {ENREF: citation text}\r\n        citationMatching = findMatchingCitation(context, citationList, bookmarkList); // object with {ENREF: citation list index}\r\n        assignHeroLinks(context, url, linkRanges, citationMatching, citationList);\r\n        bibSearch = searchForBibText(context, body, bookmarkList, citationMatching); // search for text ranges based on citation text\r\n        document.getElementById(\"progress-text\").innerHTML = \"Adding links in bibliography...\";\r\n\r\n        return context.sync();\r\n      })\r\n      .then(function () {\r\n        // split up text ranges\r\n\r\n        bibSearch2 = organizeBibText(context, bibSearch);\r\n        return context.sync();\r\n      })\r\n      .then(function () {\r\n        // find text range to link\r\n        bibSearch3 = findBibTextToLink(context, bibSearch2);\r\n        return context.sync();\r\n      })\r\n      .then(function () {\r\n        // write links to bib ranges\r\n        writeBibLinks(context, url, bibSearch3, citationMatching, citationList);\r\n\r\n        var docBody = context.document.body;\r\n        oldBodyXML = docBody.getOoxml();\r\n        document.getElementById(\"progress-text\").innerHTML = \"Changing first bibliography entry...\";\r\n        return context.sync();\r\n      })\r\n      .then(function () {\r\n        var docBody = context.document.body;\r\n        var newXML = fixProblems(context, url, oParser, oldBodyXML.value, bookmarkList, citationMatching, citationList);\r\n        docBody.insertOoxml(newXML, \"Replace\");\r\n\r\n        // change display for output\r\n        if (document.getElementById(\"error-box\").textContent == \"Errors and Warnings\") {\r\n          document.getElementById(\"error-box\").innerHTML = '<p style=\"\">Errors and Warnings: None</p>';\r\n        }\r\n        document.getElementById(\"loader\").style.display = \"none\";\r\n        document.getElementById(\"app-body\").style.display = \"flex\";\r\n        document.getElementById(\"progress-text\").innerHTML = \"\";\r\n        return context.sync();\r\n      });\r\n  }).catch(function (error) {\r\n    document.getElementById(\"loader\").style.display = \"none\";\r\n    document.getElementById(\"app-body\").style.display = \"flex\";\r\n    document.getElementById(\"error-box\").innerHTML += \"Fatal error, script exiting...<br/>\";\r\n    document.getElementById(\"error-box\").innerHTML += \"Error: \" + error + \"<br/>\";\r\n    document.getElementById(\"progress-text\").innerHTML = \"Fatal Error\";\r\n    if (error instanceof OfficeExtension.Error) {\r\n      document.getElementById(\"error-box\").innerHTML += \"Debug info: \" + JSON.stringify(error.debugInfo) + \"<br/>\";\r\n    }\r\n  });\r\n}\r\n\r\nfunction writeString(context, string) {\r\n  // for debugging\r\n  var docBody = context.document.body;\r\n  docBody.insertParagraph(\"\" + string, \"End\");\r\n}\r\n\r\nfunction fixProblems(context, url, oParser, oldXML, bookmarkList, citationMatching, citationList) {\r\n  // fix a few problems with the code\r\n  var newXML;\r\n\r\n  // edit the xml to change the first bibliography entry\r\n  newXML = changeFirstBibEntry(context, url, oParser, oldXML, bookmarkList, citationMatching, citationList);\r\n  if (newXML !== null) {\r\n    // remove bookmarks\r\n    for (var ref in bookmarkList) {\r\n      if (!Object.prototype.hasOwnProperty.call(bookmarkList, ref)) {\r\n        continue;\r\n      }\r\n      var removeBookmark = new RegExp('<w:bookmarkStart w:id=\"\\\\d+\" w:name=\"' + ref.replace(\"#\", \"\") + '\"/>', \"g\");\r\n      newXML = newXML.replace(removeBookmark, \"\");\r\n    }\r\n    // newXML = newXML.replace(/<w:bookmarkStart w:id=\"\\d+\" w:name=\"_ENREF_\\d+\"\\/>/g, \"\");\r\n    // newXML = newXML.replace(/<w:bookmarkEnd w:id=\"\\d+\"\\/>/g, \"\");\r\n  } else {\r\n    newXML = oldXML;\r\n  }\r\n\r\n  // replace carriage returns\r\n  // newXML = newXML.replace(/&amp;#xD;/g, \" / \");\r\n\r\n  return newXML;\r\n}\r\n\r\nfunction changeFirstBibEntry(context, url, oParser, oldXML, bookmarkList, citationMatching, citationList) {\r\n  // change the XML of the first bib entry to add a link\r\n  // for some reason, the first bib entry isn't included in any one paragraph\r\n\r\n  var thisRef = \"_ENREF_1\";\r\n  if (!oldXML.includes(thisRef)) {\r\n    return null;\r\n  }\r\n  if (\"#\" + thisRef in bookmarkList) {\r\n    var newURL = getURL(url, citationList[citationMatching[\"#\" + thisRef]].label);\r\n    var citationText = encodeXml(bookmarkList[\"#\" + thisRef]);\r\n  } else {\r\n    return null;\r\n  }\r\n\r\n  // parse citation string, copied from earlier in script\r\n  var citeSplit = citationText.split(\".\");\r\n\r\n  var runningCount = 0;\r\n  var parenCount = 0;\r\n\r\n  for (var j = 0; j < citeSplit.length; j++) {\r\n    var searchMatch = citeSplit[j];\r\n    if (searchMatch.includes(\"(\")) {\r\n      parenCount = parenCount + 1;\r\n    }\r\n    if (searchMatch.includes(\")\")) {\r\n      parenCount = parenCount - 1;\r\n    }\r\n    runningCount = runningCount + searchMatch.length;\r\n    if (searchMatch.length < 4) {\r\n      continue;\r\n    }\r\n    if (searchMatch.match(/[(][^)]{4,}[a-z]?[)][.]?/)) {\r\n      break;\r\n    }\r\n    if (j > 4) {\r\n      break;\r\n    }\r\n    if (runningCount > 40 && parenCount == 0) {\r\n      break;\r\n    }\r\n  }\r\n\r\n  var combRange = \"\";\r\n  if (runningCount > 0) {\r\n    for (var q = 0; q < j + 1; q++) {\r\n      var delim = \"\";\r\n      if (q < citeSplit.length - 1) {\r\n        delim = \".\";\r\n      }\r\n      combRange = combRange + citeSplit[q] + delim;\r\n    }\r\n  }\r\n  if (combRange.length == 0) {\r\n    document.getElementById(\"error-box\").innerHTML +=\r\n      '<p class=\"p-warn\"><span class=\"style-err\">' +\r\n      \"Could not find any text to link in the first citation.</span></p>\";\r\n    return null;\r\n  }\r\n\r\n  // find section to change\r\n  var finalXMLstr = \"\";\r\n  var xmlDOM = oParser.parseFromString(oldXML, \"text/xml\");\r\n  var bookmarkList2 = xmlDOM.getElementsByTagName(\"w:bookmarkStart\");\r\n  for (var a = 0; a < bookmarkList2.length; a++) {\r\n    var bookmark = bookmarkList2[a];\r\n    if (bookmark.hasAttribute(\"w:name\") && bookmark.getAttribute(\"w:name\") == \"_ENREF_1\") {\r\n      // get correct element, get parent, insert text in right place\r\n      var thisParagraph = bookmark.parentNode;\r\n      if (thisParagraph.nodeName != \"w:p\" || !thisParagraph.hasAttribute(\"w:rsidRPr\")) {\r\n        continue;\r\n      }\r\n      var rsid = thisParagraph.getAttribute(\"w:rsidRPr\");\r\n\r\n      var newText =\r\n        \"\" +\r\n        '<w:r><w:fldChar w:fldCharType=\"begin\"/></w:r>' +\r\n        '<w:r><w:instrText xml:space=\"preserve\"> HYPERLINK \"' +\r\n        newURL +\r\n        '\" </w:instrText></w:r>' +\r\n        '<w:r><w:fldChar w:fldCharType=\"separate\"/></w:r>' +\r\n        '<w:r w:rsidRPr=\"' +\r\n        rsid +\r\n        '\"><w:rPr><w:rStyle w:val=\"Hyperlink\"/></w:rPr>' +\r\n        \"<w:t>\" +\r\n        combRange +\r\n        \"</w:t></w:r>\" +\r\n        '<w:r><w:fldChar w:fldCharType=\"end\"/></w:r>';\r\n\r\n      var splitMatch = oldXML.match(/<w:bookmarkStart w:id=\"\\d+\" w:name=\"_ENREF_1\"\\/>/);\r\n      if (!splitMatch) {\r\n        continue;\r\n      }\r\n      var splitStr = splitMatch[0];\r\n      var splitArr = oldXML.split(splitStr);\r\n      finalXMLstr = splitArr[0] + splitStr + newText + splitArr[1];\r\n\r\n      break;\r\n    } else {\r\n      continue;\r\n    }\r\n  }\r\n\r\n  if (finalXMLstr.length == 0) {\r\n    document.getElementById(\"error-box\").innerHTML +=\r\n      '<p class=\"p-warn\"><span class=\"style-err\">' + \"Could not add a link to the first bibliography entry.</span></p>\";\r\n    return null;\r\n  }\r\n\r\n  var xmlStringedit = finalXMLstr.replace(citationText, citationText.replace(combRange, \"\"));\r\n\r\n  return xmlStringedit;\r\n}\r\n\r\nfunction writeBibLinks(context, url, bibSearch3, citationMatching, citationList) {\r\n  // write hyperlinks onto ranges\r\n  for (var ref in bibSearch3) {\r\n    if (!Object.prototype.hasOwnProperty.call(bibSearch3, ref)) {\r\n      continue;\r\n    }\r\n    var label = citationList[citationMatching[ref]].label;\r\n    var searchList = bibSearch3[ref];\r\n    for (var i = 0; i < searchList.length; i++) {\r\n      var searchCollection = searchList[i];\r\n\r\n      searchCollection.hyperlink = getURL(url, label);\r\n    }\r\n  }\r\n}\r\n\r\nfunction findBibTextToLink(context, bibSearch2) {\r\n  // find ranges to change into hyperlinks\r\n  var bibSearch3 = new Object();\r\n\r\n  for (var ref in bibSearch2) {\r\n    if (!Object.prototype.hasOwnProperty.call(bibSearch2, ref)) {\r\n      continue;\r\n    }\r\n    var searchCollectionList = bibSearch2[ref];\r\n\r\n    var searchList = [];\r\n    for (var i = 0; i < searchCollectionList.length; i++) {\r\n      // should only have length of 1\r\n      var searchCollection = searchCollectionList[i];\r\n      var runningCount = 0;\r\n      var parenCount = 0;\r\n      for (var j = 0; j < searchCollection.items.length; j++) {\r\n        var searchMatch = searchCollection.items[j];\r\n        if (searchMatch.text.includes(\"(\")) {\r\n          parenCount = parenCount + 1;\r\n        }\r\n        if (searchMatch.text.includes(\")\")) {\r\n          parenCount = parenCount - 1;\r\n        }\r\n        runningCount = runningCount + searchMatch.text.length;\r\n        if (searchMatch.text.length < 4) {\r\n          continue;\r\n        }\r\n        if (searchMatch.text.match(/[(][^)]{4,}[a-z]?[)][.]?/)) {\r\n          break;\r\n        }\r\n        if (j > 4) {\r\n          break;\r\n        }\r\n        if (runningCount > 40 && parenCount == 0) {\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (runningCount > 0) {\r\n        var combRange = searchCollection.items[0].getRange().expandTo(searchCollection.items[j].getRange()).getRange();\r\n        combRange.load(\"text, hyperlink\");\r\n        searchList.push(combRange);\r\n      } else {\r\n        document.getElementById(\"error-box\").innerHTML +=\r\n          '<p class=\"p-warn\"><span class=\"style-err\">' +\r\n          \"Could find text to add ref \" +\r\n          ref +\r\n          \" to a bibliography entry.</span></p>\";\r\n      }\r\n    }\r\n    bibSearch3[ref] = searchList;\r\n  }\r\n  return bibSearch3;\r\n}\r\n\r\nfunction organizeBibText(context, bibSearch) {\r\n  // split the search results into text ranges\r\n  var bibSearch2 = new Object();\r\n  for (var ref in bibSearch) {\r\n    if (!Object.prototype.hasOwnProperty.call(bibSearch, ref)) {\r\n      continue;\r\n    }\r\n    var searchList = [];\r\n    var searchCollection = bibSearch[ref];\r\n    for (var j = 0; j < searchCollection.items.length; j++) {\r\n      var searchMatch = searchCollection.items[j];\r\n      var searchResults = searchMatch.getTextRanges([\".\"]);\r\n      searchResults.load(\"text\");\r\n      searchList.push(searchResults);\r\n    }\r\n    bibSearch2[ref] = searchList;\r\n  }\r\n  return bibSearch2;\r\n}\r\n\r\nfunction searchForBibText(context, body, bookmarkList, citationMatching) {\r\n  /*\r\n    now we have an object with {label: citation text}\r\n    we need to search the text for (citation text), get the part to underline, and assign a hyperlink\r\n    */\r\n  var searchList = new Object();\r\n  for (var ref in bookmarkList) {\r\n    if (!Object.prototype.hasOwnProperty.call(bookmarkList, ref)) {\r\n      continue;\r\n    }\r\n    if (!Object.prototype.hasOwnProperty.call(citationMatching, ref)) {\r\n      continue;\r\n    }\r\n    if (ref == \"#_ENREF_1\") {\r\n      continue;\r\n    }\r\n    var searchResults = body.search(bookmarkList[ref].substring(0, 255), { matchCase: true });\r\n    searchResults.load(\"items, text\");\r\n    searchList[ref] = searchResults;\r\n  }\r\n  return searchList;\r\n}\r\n\r\nfunction assignHeroLinks(context, url, linkRanges, citationMatching, citationList) {\r\n  // change links in document\r\n  for (var n = 0; n < linkRanges.items.length; n++) {\r\n    var oldURL = linkRanges.items[n].hyperlink;\r\n    var oldText = linkRanges.items[n].text;\r\n\r\n    if (oldURL in citationMatching && oldURL != oldText) {\r\n      var newURL = getURL(url, citationList[citationMatching[oldURL]].label);\r\n\r\n      linkRanges.items[n].hyperlink = newURL;\r\n    } else {\r\n      var changedURL = changeURL(url, oldURL);\r\n      if (changedURL !== null) {\r\n        if (oldText == oldURL) {\r\n          linkRanges.items[n].insertText(changedURL, \"Replace\");\r\n        }\r\n        linkRanges.items[n].hyperlink = changedURL;\r\n      } else if (oldText != oldURL) {\r\n        var errStyle = \"info\";\r\n        if (oldURL.includes(\"_ENREF_\")) {\r\n          linkRanges.items[n].font.highlightColor = \"#FFFF00\";\r\n          errStyle = \"err\";\r\n        }\r\n        document.getElementById(\"error-box\").innerHTML +=\r\n          '<p class=\"p-warn\"><span class=\"style-' +\r\n          errStyle +\r\n          '\">' +\r\n          'Hyperlink \"' +\r\n          oldText +\r\n          '\" (\"' +\r\n          oldURL +\r\n          '\")' +\r\n          \" not changed.</span></p>\";\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction findMatchingCitation(context, citationList, bookmarkList) {\r\n  // match bib entries to a citation\r\n\r\n  // use year/author/title/check other info\r\n  // make an object with enref: label\r\n  // check how many factors match, if less than all, iterate through all citations to check\r\n  // {label: thisLabel, author: thisAuthor, year: thisYear, title: thisTitle}\r\n  // there may be duplicate citations\r\n\r\n  var returnValue = new Object();\r\n  var usedCitations = [];\r\n  for (var ref in bookmarkList) {\r\n    if (!Object.prototype.hasOwnProperty.call(bookmarkList, ref)) {\r\n      continue;\r\n    }\r\n    var citeInd = -1;\r\n    var thisBib = bookmarkList[ref];\r\n    var tieBreak = -1;\r\n    for (var a = 0; a < citationList.length; a++) {\r\n      if (usedCitations.includes(a)) {\r\n        continue;\r\n      }\r\n      var thisCitation = citationList[a];\r\n      var checkPass = 0;\r\n\r\n      // check for matching text\r\n      if (thisCitation.author != \"\" && thisBib.includes(thisCitation.author)) {\r\n        checkPass += 2;\r\n      }\r\n      if (thisCitation.year != \"\" && thisBib.includes(thisCitation.year)) {\r\n        checkPass += 1;\r\n      }\r\n      if (thisCitation.title != \"\" && thisBib.includes(thisCitation.title)) {\r\n        checkPass += 4;\r\n      }\r\n\r\n      if (checkPass == 7) {\r\n        citeInd = a;\r\n        tieBreak = checkPass;\r\n        break;\r\n      }\r\n\r\n      if (checkPass < 4) {\r\n        continue;\r\n      }\r\n\r\n      if (citeInd != -1) {\r\n        if (checkPass > tieBreak) {\r\n          citeInd = a;\r\n          tieBreak = checkPass;\r\n        } else if (checkPass == tieBreak) {\r\n          // keep current one\r\n        } else {\r\n          // keep current one\r\n        }\r\n      } else {\r\n        citeInd = a;\r\n        tieBreak = checkPass;\r\n      }\r\n    }\r\n    if (citeInd == -1) {\r\n      document.getElementById(\"error-box\").innerHTML +=\r\n        '<p class=\"p-warn\"><span class=\"style-err\">' +\r\n        'Could not find a matching citation for bib entry \"' +\r\n        thisBib.split(\".\")[0] +\r\n        '...\".</span></p>';\r\n    } else {\r\n      if (tieBreak < 7) {\r\n        document.getElementById(\"error-box\").innerHTML +=\r\n          '<p class=\"p-warn\"><span class=\"style-warn\">' +\r\n          'Matched citation for bib entry \"' +\r\n          thisBib.split(\".\")[0] +\r\n          '...\", but it was not a full match.</span></p>';\r\n      }\r\n      returnValue[ref] = citeInd;\r\n      usedCitations.push(citeInd);\r\n    }\r\n  }\r\n  return returnValue;\r\n}\r\n\r\nfunction getBibCitations(context, xmlDOM) {\r\n  // search for the bibliography text\r\n  // there is a preview api for the bookmark that would be good to switch to\r\n\r\n  // var bibXML = OoxmlList[1].value;\r\n  var returnValue = new Object();\r\n  var bookmarkList = xmlDOM.getElementsByTagName(\"w:bookmarkStart\");\r\n  for (var a = 0; a < bookmarkList.length; a++) {\r\n    var bookmark = bookmarkList[a];\r\n    if (bookmark.hasAttribute(\"w:name\")) {\r\n      var anchorName = bookmark.getAttribute(\"w:name\");\r\n      if (!anchorName.includes(\"_ENREF_\")) {\r\n        continue;\r\n      }\r\n\r\n      // get text for citation\r\n      var findText = bookmark.nextSibling;\r\n      var foundText = false;\r\n      var citeValue;\r\n      while (!foundText && findText !== null) {\r\n        if (findText.nodeName == \"w:r\") {\r\n          var textNode = findText.firstChild;\r\n          if (textNode !== null && textNode.nodeName == \"w:t\") {\r\n            // if (textNode.hasAttribute(\"xml:space\") && textNode.getAttribute(\"xml:space\") == \"preserve\") {\r\n            var textValue = textNode.textContent;\r\n            if (textValue !== null && textValue.length > 40) {\r\n              foundText = true;\r\n              citeValue = textValue;\r\n              continue;\r\n            }\r\n          }\r\n        }\r\n        findText = findText.nextSibling;\r\n      }\r\n      if (!foundText) {\r\n        continue;\r\n      }\r\n\r\n      // set return values\r\n      returnValue[\"#\" + anchorName] = citeValue;\r\n    } else {\r\n      // no bookmark name, skip\r\n      continue;\r\n    }\r\n  }\r\n\r\n  return returnValue;\r\n}\r\n\r\nfunction getCitationList(context, xmlDOM) {\r\n  // get list of citations from XML\r\n\r\n  var decodeList = [];\r\n  var citationList = [];\r\n  var citationGet = xmlDOM.getElementsByTagName(\"w:instrText\");\r\n  var extraGet = xmlDOM.getElementsByTagName(\"w:fldData\");\r\n  if (extraGet === null) {\r\n    extraGet = [];\r\n  }\r\n  if (extraGet.length > 0) {\r\n    decodeList.push(extraGet[0].textContent);\r\n  }\r\n  var sameCt = 0;\r\n\r\n  for (var aa = 1; aa < extraGet.length; aa++) {\r\n    if (extraGet[aa - 1].textContent != extraGet[aa].textContent || sameCt > 0) {\r\n      decodeList.push(extraGet[aa].textContent);\r\n      sameCt = 0;\r\n    } else {\r\n      sameCt += 1;\r\n    }\r\n  }\r\n  var decodeCt = 0;\r\n  for (var jj = 0; jj < citationGet.length; jj++) {\r\n    var tempContent = citationGet[jj].textContent;\r\n    if (tempContent.includes(\" ADDIN EN.CITE \") && tempContent != \" ADDIN EN.CITE \") {\r\n      citationList.push(tempContent);\r\n    }\r\n    if (extraGet.length > 0 && tempContent == \" ADDIN EN.CITE.DATA \") {\r\n      citationList.push(\"DECODE\");\r\n      decodeCt += 1;\r\n    }\r\n  }\r\n\r\n  // this checks to make sure the number of EN.CITE.DATA matches the number of w:fldData tags\r\n  var canDecode = true;\r\n  if (decodeCt != decodeList.length) {\r\n    document.getElementById(\"error-box\").innerHTML +=\r\n      '<p class=\"p-warn\"><span class=\"style-err\">' +\r\n      \"Error decoding citations; could not match citations to fields.</span></p>\";\r\n    canDecode = false;\r\n  }\r\n\r\n  // decode data\r\n  var newCitationText = []; // list of citation objects\r\n  var citeCt = 0;\r\n  for (var dd = 0; dd < citationList.length; dd++) {\r\n    // decode citations and make object for each with text data\r\n    var decoded;\r\n    if (citationList[dd] == \"DECODE\") {\r\n      decoded = \"\";\r\n      if (canDecode) {\r\n        var decodeText = decodeList[citeCt].split(\"\\n\"); // string of base64\r\n        for (var tt = 0; tt < decodeText.length; tt++) {\r\n          var thisText = decodeText[tt].replace(\"\\r\", \"\");\r\n          if (thisText.length > 0) {\r\n            decoded += Base64.decode(thisText);\r\n          }\r\n        }\r\n      }\r\n      // decoded = decodeXml(decoded);\r\n      citeCt += 1;\r\n    } else {\r\n      decoded = citationList[dd];\r\n    }\r\n\r\n    if (decoded.length > 0) {\r\n      // make citation objects\r\n      newCitationText = fixCombinedCitations(context, newCitationText, decoded);\r\n    }\r\n  }\r\n  return newCitationText;\r\n}\r\n\r\nfunction decodeXml(string) {\r\n  // derived from https://stackoverflow.com/questions/7918868\r\n  return string.replace(/(&quot;|&lt;|&gt;|&amp;|&apos;)/g, function (c) {\r\n    switch (c) {\r\n      case \"&lt;\":\r\n        return \"<\";\r\n      case \"&gt;\":\r\n        return \">\";\r\n      case \"&amp;\":\r\n        return \"&\";\r\n      case \"&apos;\":\r\n        return \"'\";\r\n      case \"&quot;\":\r\n        return '\"';\r\n    }\r\n  });\r\n}\r\n\r\nfunction encodeXml(string) {\r\n  // derived from https://stackoverflow.com/questions/7918868\r\n  return string.replace(/(<|>|&|'|\")/g, function (c) {\r\n    switch (c) {\r\n      case \"<\":\r\n        return \"&lt;\";\r\n      case \">\":\r\n        return \"&gt;\";\r\n      case \"&\":\r\n        return \"&amp;\";\r\n      case \"'\":\r\n        return \"&apos;\";\r\n      case '\"':\r\n        return \"&quot;\";\r\n    }\r\n  });\r\n}\r\n\r\nfunction fixCombinedCitations(context, newCitationText, decoded) {\r\n  // pull citation data out of combined citations\r\n\r\n  // check to see if the text is indeed a citation\r\n  if (!decoded.includes(\"<EndNote><Cite>\")) {\r\n    return newCitationText;\r\n  }\r\n\r\n  var tempList = new Object(); // object for checking for dups\r\n  var matchCitations = decoded.split(\"<Cite>\");\r\n  for (var ww = 0; ww < matchCitations.length; ww++) {\r\n    var thisAuthor = \"\";\r\n    var thisYear = \"\";\r\n    var thisLabel = \"\";\r\n    var thisTitle = \"\";\r\n\r\n    var matchLabelTest = matchCitations[ww].match(/<label>(\\d{1,})<\\/label>/g);\r\n    if (matchLabelTest) {\r\n      if (matchLabelTest.length == 1) {\r\n        thisLabel = matchLabelTest[0];\r\n      } else {\r\n        // prevent duplicate labels\r\n        var tempLabel = [];\r\n        for (var cc = 0; cc < matchLabelTest.length; cc++) {\r\n          if (!tempLabel.includes(matchLabelTest[cc])) {\r\n            tempLabel.push(matchLabelTest[cc]);\r\n          }\r\n        }\r\n        if (tempLabel.length == 1) {\r\n          thisLabel = tempLabel[0];\r\n        } else {\r\n          // leave label blank\r\n        }\r\n      }\r\n    }\r\n\r\n    // don't add if duplicate or blank\r\n    if (thisLabel == \"\") {\r\n      continue;\r\n    }\r\n    thisLabel = thisLabel.match(/<label>(\\d{1,})<\\/label>/)[1];\r\n    // if (labelList.includes(thisLabel)) {continue;}\r\n\r\n    var matchAuthor = matchCitations[ww].match(/<Author>([^<>/]{1,})<\\/Author>/);\r\n    var matchAuthorTest = matchCitations[ww].match(/<Author>([^<>/]{1,})<\\/Author>/g);\r\n    if (matchAuthor && matchAuthorTest && matchAuthorTest.length == 1) {\r\n      thisAuthor = decodeXml(matchAuthor[1]);\r\n    }\r\n    var matchYear = matchCitations[ww].match(/<Year>(\\d{4})<\\/Year>/);\r\n    var matchYearTest = matchCitations[ww].match(/<Year>(\\d{4})<\\/Year>/g);\r\n    if (matchYear && matchYearTest && matchYearTest.length == 1) {\r\n      thisYear = matchYear[1];\r\n    }\r\n    var matchTitle = matchCitations[ww].match(/<title>([^<>]{1,})<\\/title>/);\r\n    var matchTitleTest = matchCitations[ww].match(/<title>([^<>]{1,})<\\/title>/g);\r\n    if (matchTitle && matchTitleTest && matchTitleTest.length == 1) {\r\n      thisTitle = decodeXml(matchTitle[1]);\r\n    }\r\n\r\n    // check for duplicate citations\r\n    var combData = thisAuthor + thisYear + thisTitle;\r\n    if (thisLabel in tempList) {\r\n      if (tempList[thisLabel].includes(combData)) {\r\n        continue;\r\n      } else {\r\n        tempList[thisLabel].push(combData);\r\n      }\r\n    } else {\r\n      tempList[thisLabel] = [combData];\r\n    }\r\n\r\n    var newCitation = { label: thisLabel, author: thisAuthor, year: thisYear, title: thisTitle };\r\n    newCitationText.push(newCitation);\r\n  }\r\n  return newCitationText;\r\n}\r\n"],"names":["factory","self","window","global","tab","_hasatob","atob","_hasbtoa","btoa","_hasBuffer","Buffer","_TD","TextDecoder","undefined","_TE","TextEncoder","b64chs","Array","prototype","slice","call","b64tab","forEach","c","i","b64re","_fromCC","String","fromCharCode","bind","_U8Afrom","Uint8Array","from","it","fn","x","map","_mkUriSafe","src","replace","m0","_tidyB64","s","btoaPolyfill","bin","u32","c0","c1","c2","asc","pad","length","charCodeAt","TypeError","substring","_btoa","toString","_fromUint8Array","u8a","strs","l","push","apply","subarray","join","fromUint8Array","urlsafe","cb_utob","cc","re_utob","utob","u","_encode","encode","encodeURI","re_btou","cb_btou","cccc","offset","btou","b","atobPolyfill","test","u24","r1","r2","charAt","_atob","_toUint8Array","a","toUint8Array","_unURI","_decode","decode","_noEnum","v","value","enumerable","writable","configurable","extendString","_add","name","body","Object","defineProperty","this","extendUint8Array","gBase64","version","VERSION","fromBase64","toBase64","encodeURL","isValid","extendBuiltins","keys","k","Base64","exports","module","define","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","definition","key","o","get","g","globalThis","Function","e","obj","prop","hasOwnProperty","getURL","url","label","newURL","changeURL","oldURL","heroURL","heroNetURL","includes","changeCitations","Word","run","context","document","getElementById","innerHTML","style","display","bodyOoxml","getOoxml","linkRanges","getRange","getHyperlinkRanges","load","bibSearch","bibSearch2","bibSearch3","citationList","citationMatching","bookmarkList","oldBodyXML","oParser","DOMParser","sync","then","xmlDOM","parseFromString","decodeList","citationGet","getElementsByTagName","extraGet","textContent","sameCt","aa","decodeCt","jj","tempContent","canDecode","newCitationText","citeCt","dd","decoded","decodeText","split","tt","thisText","fixCombinedCitations","getCitationList","returnValue","bookmark","hasAttribute","anchorName","getAttribute","citeValue","findText","nextSibling","foundText","nodeName","textNode","firstChild","textValue","getBibCitations","usedCitations","ref","citeInd","thisBib","tieBreak","thisCitation","checkPass","author","year","title","findMatchingCitation","items","hyperlink","oldText","text","changedURL","insertText","errStyle","font","highlightColor","assignHeroLinks","searchList","searchResults","search","matchCase","searchForBibText","searchCollection","j","getTextRanges","organizeBibText","searchCollectionList","runningCount","parenCount","searchMatch","match","combRange","expandTo","findBibTextToLink","writeBibLinks","docBody","newXML","oldXML","thisRef","citationText","citeSplit","q","delim","finalXMLstr","bookmarkList2","thisParagraph","parentNode","newText","splitMatch","splitStr","splitArr","changeFirstBibEntry","removeBookmark","RegExp","fixProblems","insertOoxml","catch","error","OfficeExtension","Error","JSON","stringify","debugInfo","decodeXml","string","tempList","matchCitations","ww","thisAuthor","thisYear","thisLabel","thisTitle","matchLabelTest","tempLabel","matchAuthor","matchAuthorTest","matchYear","matchYearTest","matchTitle","matchTitleTest","combData","newCitation","Office","onReady","info","host","HostType","requirements","isSetSupported","config","extendedErrorLogging","onclick"],"sourceRoot":""}