/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={49666:function(e,t,n){var r,o,i;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g&&n.g,i=function(){"use strict";var e,t="3.7.5",n=t,r="function"==typeof atob,o="function"==typeof btoa,i="function"==typeof Buffer,a="function"==typeof TextDecoder?new TextDecoder:void 0,c="function"==typeof TextEncoder?new TextEncoder:void 0,u=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),l=(e={},u.forEach((function(t,n){return e[t]=n})),e),s=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,f=String.fromCharCode.bind(String),d="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e){return new Uint8Array(Array.prototype.slice.call(e,0))},h=function(e){return e.replace(/=/g,"").replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"}))},p=function(e){return e.replace(/[^A-Za-z0-9\+\/]/g,"")},y=function(e){for(var t,n,r,o,i="",a=e.length%3,c=0;c<e.length;){if((n=e.charCodeAt(c++))>255||(r=e.charCodeAt(c++))>255||(o=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");i+=u[(t=n<<16|r<<8|o)>>18&63]+u[t>>12&63]+u[t>>6&63]+u[63&t]}return a?i.slice(0,a-3)+"===".substring(a):i},m=o?function(e){return btoa(e)}:i?function(e){return Buffer.from(e,"binary").toString("base64")}:y,g=i?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],n=0,r=e.length;n<r;n+=4096)t.push(f.apply(null,e.subarray(n,n+4096)));return m(t.join(""))},v=function(e,t){return void 0===t&&(t=!1),t?h(g(e)):g(e)},b=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?f(192|t>>>6)+f(128|63&t):f(224|t>>>12&15)+f(128|t>>>6&63)+f(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return f(240|t>>>18&7)+f(128|t>>>12&63)+f(128|t>>>6&63)+f(128|63&t)},x=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,E=function(e){return e.replace(x,b)},w=i?function(e){return Buffer.from(e,"utf8").toString("base64")}:c?function(e){return g(c.encode(e))}:function(e){return m(E(e))},I=function(e,t){return void 0===t&&(t=!1),t?h(w(e)):w(e)},B=function(e){return I(e,!0)},A=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,L=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return f(55296+(t>>>10))+f(56320+(1023&t));case 3:return f((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return f((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},O=function(e){return e.replace(A,L)},C=function(e){if(e=e.replace(/\s+/g,""),!s.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));for(var t,n,r,o="",i=0;i<e.length;)t=l[e.charAt(i++)]<<18|l[e.charAt(i++)]<<12|(n=l[e.charAt(i++)])<<6|(r=l[e.charAt(i++)]),o+=64===n?f(t>>16&255):64===r?f(t>>16&255,t>>8&255):f(t>>16&255,t>>8&255,255&t);return o},T=r?function(e){return atob(p(e))}:i?function(e){return Buffer.from(e,"base64").toString("binary")}:C,k=i?function(e){return d(Buffer.from(e,"base64"))}:function(e){return d(T(e).split("").map((function(e){return e.charCodeAt(0)})))},S=function(e){return k(N(e))},j=i?function(e){return Buffer.from(e,"base64").toString("utf8")}:a?function(e){return a.decode(k(e))}:function(e){return O(T(e))},N=function(e){return p(e.replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})))},D=function(e){return j(N(e))},F=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}},P=function(){var e=function(e,t){return Object.defineProperty(String.prototype,e,F(t))};e("fromBase64",(function(){return D(this)})),e("toBase64",(function(e){return I(this,e)})),e("toBase64URI",(function(){return I(this,!0)})),e("toBase64URL",(function(){return I(this,!0)})),e("toUint8Array",(function(){return S(this)}))},_=function(){var e=function(e,t){return Object.defineProperty(Uint8Array.prototype,e,F(t))};e("toBase64",(function(e){return v(this,e)})),e("toBase64URI",(function(){return v(this,!0)})),e("toBase64URL",(function(){return v(this,!0)}))},H={version:t,VERSION:n,atob:T,atobPolyfill:C,btoa:m,btoaPolyfill:y,fromBase64:D,toBase64:I,encode:I,encodeURI:B,encodeURL:B,utob:E,btou:O,decode:D,isValid:function(e){if("string"!=typeof e)return!1;var t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:v,toUint8Array:S,extendString:P,extendUint8Array:_,extendBuiltins:function(){P(),_()},Base64:{}};return Object.keys(H).forEach((function(e){return H.Base64[e]=H[e]})),H},"object"===a(t)?e.exports=i():void 0===(o="function"==typeof(r=i)?r.call(t,n,t,e):r)||(e.exports=o)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=n(49666);function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(){r=function(){return e};var e={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),c=new O(r||[]);return i(a,"_invoke",{value:I(e,n,c)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=f;var h={};function p(){}function y(){}function m(){}var g={};s(g,c,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(C([])));b&&b!==n&&o.call(b,c)&&(g=b);var x=m.prototype=p.prototype=Object.create(g);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,n){function r(i,a,c,u){var l=d(e[i],e,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==t(f)&&o.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,c,u)}),(function(e){r("throw",e,c,u)})):n.resolve(f).then((function(e){s.value=e,c(s)}),(function(e){return r("throw",e,c,u)}))}u(l.arg)}var a;i(this,"_invoke",{value:function(e,t){function o(){return new n((function(n,o){r(e,t,n,o)}))}return a=a?a.then(o,o):o()}})}function I(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=B(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=d(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function B(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,B(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=d(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=m,i(x,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:y,configurable:!0}),y.displayName=s(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,s(e,l,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},E(w.prototype),s(w.prototype,u,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(f(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(x),s(x,l,"Generator"),s(x,c,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=C,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function o(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function c(e){o(a,r,i,c,u,"next",e)}function u(e){o(a,r,i,c,u,"throw",e)}c(void 0)}))}}function a(e,t){var n;return"hero"==e&&(n="https://hero.epa.gov/hero/index.cfm/reference/details/reference_id/"+t),"heronet"==e&&(n="http://heronet.epa.gov/heronet/index.cfm/reference/details/reference_id/"+t),n}function c(e){return u.apply(this,arguments)}function u(){return u=i(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=i(r().mark((function e(n){var o,i,a,c,u,v,b,x,E,w,I,B,A,L;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("error-box").innerHTML='<p style="">Errors and Warnings</p>',document.getElementById("loader").style.display="flex",document.getElementById("app-body").style.display="none",document.getElementById("progress-text").innerHTML="Changing links...",o=n.document.body,i=o.getOoxml(),(a=o.getRange("Content").getHyperlinkRanges()).load("items, items/length, hyperlink, text, font"),e.next=10,n.sync();case 10:for(c=new DOMParser,I=c.parseFromString(i.value,"text/xml"),b=g(n,I),E=m(0,I),x=y(0,b,E),B=new Object,A=1;A<=a.items.length;A++)L=a.items[A-1],B[L.text]=!0,p(0,t,L,x,b);return w=s(0,o,b,x,B),u=h(0,o,E,x),e.next=21,n.sync();case 21:return l(0,w),v=d(0,u),document.getElementById("progress-text").innerHTML="Adding links to bibliography...",e.next=26,n.sync();case 26:return f(0,t,v,x,b),"Errors and Warnings"==document.getElementById("error-box").textContent&&(document.getElementById("error-box").innerHTML='<p style="">Errors and Warnings: None</p>'),document.getElementById("loader").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("progress-text").innerHTML="",e.next=33,n.sync();case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){document.getElementById("loader").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("error-box").innerHTML+="Fatal error, script exiting...<br/>",document.getElementById("error-box").innerHTML+="Error: "+e+"<br/>",document.getElementById("progress-text").innerHTML="Fatal Error",e instanceof OfficeExtension.Error&&(document.getElementById("error-box").innerHTML+="Debug info: "+JSON.stringify(e.debugInfo)+"<br/>")}));case 2:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function l(e,t){for(var n=0;n<t.length;n++)for(var r=t[n],o=0;o<r.items.length;o++){var i=r.items[o],a=i.text;document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-warn">Fixing link "'+a+'."</span></p>',i.hyperlink=a}}function s(e,t,n,r,o){for(var i=[],a=0;a<n.length;a++){var c=n[a].url;if(null!=c&&""!=c&&!(c in r)&&!(c in o)){var u=t.search(c,{matchCase:!0});u.load("items, text"),i.push(u)}}return i}function f(e,t,n,r,o){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i))for(var c=o[r[i]].label,u=n[i],l=0;l<u.length;l++)for(var s=u[l],f=0;f<s.items.length;f++)s.items[f].hyperlink=a(t,c)}function d(e,t){var n=new Object;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){for(var o=t[r],i=[],a=0;a<o.items.length;a++){for(var c=o.items[a],u=c.text.split("."),l=0,s=0,f=0;f<u.length;f++){var d=u[f];if(d.includes("(")&&(s+=1),d.includes(")")&&(s-=1),l+=d.length,!(d.length<4)){if(d.match(/[(][^)]{4,}[a-z]?[)][.]?/))break;if(f>4)break;if(l>40&&0==s)break}}if(l>0){var h=c.search(u.slice(0,f+1).join("."),{matchCase:!0});h.load("items, text, hyperlink"),i.push(h)}else document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Could find text to add ref '+r+" to a bibliography entry.</span></p>"}n[r]=i}return n}function h(e,t,n,r){var o=new Object;for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&Object.prototype.hasOwnProperty.call(r,i)){var a=t.search(n[i].join("").substring(0,255),{matchCase:!0});a.load("items, text"),o[i]=a}return o}function p(e,t,n,r,o){var i=n.hyperlink,c=n.text,u=encodeURI(n.text).replace(/%\w\w/g,(function(e){return e.toLowerCase()}));if(null==i||""==c);else if(i in r&&i!=c){var l=a(t,o[r[i]].label);n.hyperlink=l}else{var s=function(e,t){var n,r="https://hero.epa.gov/hero/index.cfm/reference/details/reference_id/",o="http://heronet.epa.gov/heronet/index.cfm/reference/details/reference_id/";return t.includes(r)||t.includes(o)?("hero"==e&&(n=t.replace(o,r)),"heronet"==e&&(n=t.replace(r,o)),n):null}(t,i);if(null!==s)c!=i&&u!=i||n.insertText(s,"Replace"),n.hyperlink=s;else if(c!=i&&u!=i){var f="info";i.includes("_ENREF_")&&(n.font.highlightColor="#FFFF00",f="err"),"err"!=f&&"true"!=document.getElementById("debug-enabled").value||(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-'+f+'">Hyperlink "'+c+'" ("'+i+'") not changed.</span></p>')}}}function y(e,t,n){var r=new Object,o=[];for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){for(var a=-1,c=n[i].join(""),u=-1,l=0;l<t.length;l++)if(!o.includes(l)){var s=t[l],f=0;if(""!=s.author&&c.includes(s.author)&&(f+=2),""!=s.year&&c.includes(s.year)&&(f+=1),""!=s.title&&c.includes(s.title)&&(f+=4),7==f){a=l,u=f;break}f<4||(-1!=a?f>u&&(a=l,u=f):(a=l,u=f))}-1==a?document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Could not find a matching citation for bib entry "'+c.split(".")[0]+'...".</span></p>':(u<7&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-warn">Matched citation for bib entry "'+c.split(".")[0]+'...", but it was not a full match. Some fields may be missing.</span></p>'),r[i]=a,o.push(a))}return r}function m(e,t){for(var n=new Object,r=t.getElementsByTagName("w:bookmarkStart"),o=0;o<r.length;o++){var i=r[o];if(i.hasAttribute("w:name")){var a=i.getAttribute("w:name");if(a.includes("_ENREF_")){for(var c=i.nextSibling,u=[],l=!0;null!==c;){if("w:r"==c.nodeName&&l){for(var s=c.firstChild;null!==s&&"w:t"!==s.nodeName;)s=s.nextSibling;if(null!==s&&"w:t"==s.nodeName){var f=s.textContent;null!==f&&u.push(f)}}else"w:r"!==c.nodeName&&l&&(l=!1);c=c.nextSibling}0!=u.length&&(n["#"+a]=u)}}}return n}function g(t,n){var r=[],o=[],i=n.querySelectorAll("*|instrText, *|delInstrText"),a=n.getElementsByTagName("w:fldData");null===a&&(a=[]),a.length>0&&r.push(a[0].textContent);for(var c=0,u=1;u<a.length;u++)a[u-1].textContent!=a[u].textContent||c>0?(r.push(a[u].textContent),c=0):c+=1;for(var l=0,s=[],f=!1,d=0;d<i.length;d++){var h,p=i[d].tagName,y=i[d].textContent;h="w:instrText"==p;var m=y.includes("</EndNote>");y.includes(" ADDIN EN.CITE ")&&" ADDIN EN.CITE "!=y?h?m?o.push(y):(f&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-warn">Error parsing split citation, some data may be missing.</span></p>'),f=!0,(s=[]).push(y)):o.push("SKIP"):a.length>0&&" ADDIN EN.CITE.DATA "==y?(h?o.push("DECODE"):o.push("SKIP-DECODE"),l+=1):f&&(s.push(y),m&&(o.push(s.join("")),f=!1,s=[]))}var g=!0;l!=r.length&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Error decoding citations; could not match citations to fields.</span></p>',g=!1);for(var v=[],x=0,E=0;E<o.length;E++){var w;if("DECODE"==o[E]){if(w="",g){var I=r[x].replace("\r","").replace("\n","");I.length>0&&(w=e.Base64.decode(I))}x+=1}else"SKIP"==o[E]?w="":"SKIP-DECODE"==o[E]?(w="",x+=1):w=o[E];w.length>0&&(v=b(0,v,w))}return v}function v(e){return e.replace(/(&quot;|&lt;|&gt;|&amp;|&apos;)/g,(function(e){switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"'}}))}function b(e,t,n){if(!n.includes("<EndNote><Cite"))return t;for(var r=new Object,o=n.split("<Cite"),i=0;i<o.length;i++){var a="",c="",u="",l="",s="",f=o[i].match(/<label>(\d{1,})<\/label>/g);if(f||(f=o[i].match(/<IDText>(\d{1,})<\/IDText>/g)),f)if(1==f.length)u=f[0];else{for(var d=[],h=0;h<f.length;h++)d.includes(f[h])||d.push(f[h]);1==d.length&&(u=d[0])}var p=o[i].match(/<Author>([^<>/]{1,})<\/Author>/),y=o[i].match(/<Author>([^<>/]{1,})<\/Author>/g);p&&y&&1==y.length&&(a=v(p[1]));var m=o[i].match(/<Year>(\d{4})<\/Year>/),g=o[i].match(/<Year>(\d{4})<\/Year>/g);if(m&&g&&1==g.length)c=m[1];else{var b=o[i].match(/<custom7>(In Press)<\/custom7>/),x=o[i].match(/<custom7>(In Press)<\/custom7>/g);b&&x&&1==x.length&&(c=b[1])}var E=o[i].match(/<title>([^<>]{1,})<\/title>/),w=o[i].match(/<title>([^<>]{1,})<\/title>/g);E&&w&&1==w.length&&(l=v(E[1]));var I=o[i].match(/<url>([^<>]{1,})<\/url>/),B=o[i].match(/<url>([^<>]{1,})<\/url>/g);if(I&&B&&1==B.length&&(s=v(I[1])),""!=u){var A=a+c+l;if((u=u.match(/<[a-zA-Z]{5,6}>(\d{1,})<\/[a-zA-Z]{5,6}>/)[1])in r){if(r[u].includes(A))continue;r[u].push(A)}else r[u]=[A];var L={label:u,author:a,year:c,title:l,url:s};t.push(L)}else o[i].includes(" ADDIN EN")||o[i].includes("<EndNote>")||(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">The following citation is missing a HERO ID: "'+a+" "+c+'"</span></p>')}return t}Office.onReady((function(e){e.host===Office.HostType.Word&&(Office.context.requirements.isSetSupported("WordApi","1.3")||(document.getElementById("error-box").innerHTML+="Sorry. The tutorial add-in uses Word.js APIs that are not available in your version of Office.<br/>"),OfficeExtension.config.extendedErrorLogging=!0,document.getElementById("link-hero").onclick=function(){c("hero")},document.getElementById("link-heronet").onclick=function(){c("heronet")},document.getElementById("confirm-box").onclick=function(){1==document.getElementById("confirm-box").checked?(document.getElementById("link-hero").disabled=!1,document.getElementById("link-heronet").disabled=!1):(document.getElementById("link-hero").disabled=!0,document.getElementById("link-heronet").disabled=!0)},document.getElementById("version-text").onclick=function(){"true"==document.getElementById("debug-enabled").value?(document.getElementById("debug-enabled").value="false",document.getElementById("debug-marker").textContent=""):(document.getElementById("debug-enabled").value="true",document.getElementById("debug-marker").textContent=" (debug)")},document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("progress-text").innerHTML="Initializing...")}))}()}();
//# sourceMappingURL=taskpane.js.map