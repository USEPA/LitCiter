/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={49666:function(e,t,n){var r,o,i;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g&&n.g,i=function(){"use strict";var e,t="3.7.5",n=t,r="function"==typeof atob,o="function"==typeof btoa,i="function"==typeof Buffer,a="function"==typeof TextDecoder?new TextDecoder:void 0,c="function"==typeof TextEncoder?new TextEncoder:void 0,u=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),l=(e={},u.forEach((function(t,n){return e[t]=n})),e),s=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,f=String.fromCharCode.bind(String),d="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e){return new Uint8Array(Array.prototype.slice.call(e,0))},h=function(e){return e.replace(/=/g,"").replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"}))},p=function(e){return e.replace(/[^A-Za-z0-9\+\/]/g,"")},y=function(e){for(var t,n,r,o,i="",a=e.length%3,c=0;c<e.length;){if((n=e.charCodeAt(c++))>255||(r=e.charCodeAt(c++))>255||(o=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");i+=u[(t=n<<16|r<<8|o)>>18&63]+u[t>>12&63]+u[t>>6&63]+u[63&t]}return a?i.slice(0,a-3)+"===".substring(a):i},g=o?function(e){return btoa(e)}:i?function(e){return Buffer.from(e,"binary").toString("base64")}:y,m=i?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],n=0,r=e.length;n<r;n+=4096)t.push(f.apply(null,e.subarray(n,n+4096)));return g(t.join(""))},v=function(e,t){return void 0===t&&(t=!1),t?h(m(e)):m(e)},b=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?f(192|t>>>6)+f(128|63&t):f(224|t>>>12&15)+f(128|t>>>6&63)+f(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return f(240|t>>>18&7)+f(128|t>>>12&63)+f(128|t>>>6&63)+f(128|63&t)},x=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,E=function(e){return e.replace(x,b)},w=i?function(e){return Buffer.from(e,"utf8").toString("base64")}:c?function(e){return m(c.encode(e))}:function(e){return g(E(e))},I=function(e,t){return void 0===t&&(t=!1),t?h(w(e)):w(e)},B=function(e){return I(e,!0)},A=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,L=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return f(55296+(t>>>10))+f(56320+(1023&t));case 3:return f((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return f((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},O=function(e){return e.replace(A,L)},C=function(e){if(e=e.replace(/\s+/g,""),!s.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));for(var t,n,r,o="",i=0;i<e.length;)t=l[e.charAt(i++)]<<18|l[e.charAt(i++)]<<12|(n=l[e.charAt(i++)])<<6|(r=l[e.charAt(i++)]),o+=64===n?f(t>>16&255):64===r?f(t>>16&255,t>>8&255):f(t>>16&255,t>>8&255,255&t);return o},T=r?function(e){return atob(p(e))}:i?function(e){return Buffer.from(e,"base64").toString("binary")}:C,S=i?function(e){return d(Buffer.from(e,"base64"))}:function(e){return d(T(e).split("").map((function(e){return e.charCodeAt(0)})))},k=function(e){return S(N(e))},j=i?function(e){return Buffer.from(e,"base64").toString("utf8")}:a?function(e){return a.decode(S(e))}:function(e){return O(T(e))},N=function(e){return p(e.replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})))},D=function(e){return j(N(e))},F=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}},P=function(){var e=function(e,t){return Object.defineProperty(String.prototype,e,F(t))};e("fromBase64",(function(){return D(this)})),e("toBase64",(function(e){return I(this,e)})),e("toBase64URI",(function(){return I(this,!0)})),e("toBase64URL",(function(){return I(this,!0)})),e("toUint8Array",(function(){return k(this)}))},_=function(){var e=function(e,t){return Object.defineProperty(Uint8Array.prototype,e,F(t))};e("toBase64",(function(e){return v(this,e)})),e("toBase64URI",(function(){return v(this,!0)})),e("toBase64URL",(function(){return v(this,!0)}))},H={version:t,VERSION:n,atob:T,atobPolyfill:C,btoa:g,btoaPolyfill:y,fromBase64:D,toBase64:I,encode:I,encodeURI:B,encodeURL:B,utob:E,btou:O,decode:D,isValid:function(e){if("string"!=typeof e)return!1;var t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:v,toUint8Array:k,extendString:P,extendUint8Array:_,extendBuiltins:function(){P(),_()},Base64:{}};return Object.keys(H).forEach((function(e){return H.Base64[e]=H[e]})),H},"object"===a(t)?e.exports=i():void 0===(o="function"==typeof(r=i)?r.call(t,n,t,e):r)||(e.exports=o)},27091:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},97574:function(e,t,n){"use strict";e.exports=n.p+"assets/link-icon-128.png"},60806:function(e,t,n){"use strict";e.exports=n.p+"cede5d08c16181ed4c6b.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&!e;)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){"use strict";var e=n(49666);function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(){r=function(){return n};var e,n={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",s=c.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),c=new j(r||[]);return a(i,"_invoke",{value:C(e,n,c)}),i}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=d;var p="suspendedStart",y="suspendedYield",g="executing",m="completed",v={};function b(){}function x(){}function E(){}var w={};f(w,u,(function(){return this}));var I=Object.getPrototypeOf,B=I&&I(I(N([])));B&&B!==o&&i.call(B,u)&&(w=B);var A=E.prototype=b.prototype=Object.create(w);function L(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,n){function r(o,a,c,u){var l=h(e[o],e,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==t(f)&&i.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,c,u)}),(function(e){r("throw",e,c,u)})):n.resolve(f).then((function(e){s.value=e,c(s)}),(function(e){return r("throw",e,c,u)}))}u(l.arg)}var o;a(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(i,i):i()}})}function C(t,n,r){var o=p;return function(i,a){if(o===g)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=T(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var l=h(t,n,r);if("normal"===l.type){if(o=r.done?m:y,l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function T(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=h(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function N(n){if(n||""===n){var r=n[u];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,a=function t(){for(;++o<n.length;)if(i.call(n,o))return t.value=n[o],t.done=!1,t;return t.value=e,t.done=!0,t};return a.next=a}}throw new TypeError(t(n)+" is not iterable")}return x.prototype=E,a(A,"constructor",{value:E,configurable:!0}),a(E,"constructor",{value:x,configurable:!0}),x.displayName=f(E,s,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,f(e,s,"GeneratorFunction")),e.prototype=Object.create(A),e},n.awrap=function(e){return{__await:e}},L(O.prototype),f(O.prototype,l,(function(){return this})),n.AsyncIterator=O,n.async=function(e,t,r,o,i){void 0===i&&(i=Promise);var a=new O(d(e,t,r,o),i);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},L(A),f(A,s,"Generator"),f(A,u,(function(){return this})),f(A,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=N,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:N(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},n}function o(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function c(e){o(a,r,i,c,u,"next",e)}function u(e){o(a,r,i,c,u,"throw",e)}c(void 0)}))}}function a(e,t){var n;return"hero"==e&&(n="https://hero.epa.gov/hero/index.cfm/reference/details/reference_id/"+t),"heronet"==e&&(n="http://heronet.epa.gov/heronet/index.cfm/reference/details/reference_id/"+t),n}function c(e){return u.apply(this,arguments)}function u(){return u=i(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=i(r().mark((function e(n){var o,i,a,c,u,v,b,x,E,w,I,B,A,L;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("error-box").innerHTML='<p style="">Errors and Warnings</p>',document.getElementById("loader").style.display="flex",document.getElementById("app-body").style.display="none",document.getElementById("progress-text").innerHTML="Changing links...",o=n.document.body,i=o.getOoxml(),(a=o.getRange("Content").getHyperlinkRanges()).load("items, items/length, hyperlink, text, font"),e.next=10,n.sync();case 10:for(c=new DOMParser,I=c.parseFromString(i.value,"text/xml"),b=m(n,I),E=g(0,I),x=y(0,b,E),B=new Object,A=1;A<=a.items.length;A++)L=a.items[A-1],B[L.text]=!0,p(0,t,L,x,b);return w=s(0,o,b,x,B),u=h(0,o,E,x),e.next=21,n.sync();case 21:return l(0,w),v=d(0,u),document.getElementById("progress-text").innerHTML="Adding links to bibliography...",e.next=26,n.sync();case 26:return f(0,t,v,x,b),"Errors and Warnings"==document.getElementById("error-box").textContent&&(document.getElementById("error-box").innerHTML='<p style="">Errors and Warnings: None</p>'),document.getElementById("loader").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("progress-text").innerHTML="",e.next=33,n.sync();case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){document.getElementById("loader").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("error-box").innerHTML+="Fatal error, script exiting...<br/>",document.getElementById("error-box").innerHTML+="Error: "+e+"<br/>",document.getElementById("progress-text").innerHTML="Fatal Error",e instanceof OfficeExtension.Error&&(document.getElementById("error-box").innerHTML+="Debug info: "+JSON.stringify(e.debugInfo)+"<br/>")}));case 2:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function l(e,t){for(var n=0;n<t.length;n++)for(var r=t[n],o=0;o<r.items.length;o++){var i=r.items[o],a=i.text;"true"==document.getElementById("debug-enabled").value&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-warn">Fixing link "'+a+'."</span></p>'),i.hyperlink=a}}function s(e,t,n,r,o){for(var i=[],a=0;a<n.length;a++){var c=n[a].url;if(null!=c&&""!=c&&!(c in r)&&!(c in o)){var u=t.search(c,{matchCase:!0});u.load("items, text"),i.push(u)}}return i}function f(e,t,n,r,o){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i))for(var c=o[r[i]].label,u=n[i],l=0;l<u.length;l++)for(var s=u[l],f=0;f<s.items.length;f++)s.items[f].hyperlink=a(t,c)}function d(e,t){var n=new Object;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){for(var o=t[r],i=[],a=0;a<o.items.length;a++){for(var c=o.items[a],u=c.text.split("."),l=0,s=0,f=0;f<u.length;f++){var d=u[f];if(d.includes("(")&&(s+=1),d.includes(")")&&(s-=1),l+=d.length,!(d.length<4)){if(d.match(/[(][^)]{4,}[a-z]?[)][.]?/))break;if(f>4)break;if(l>40&&0==s)break}}if(l>0){var h=c.search(u.slice(0,f+1).join("."),{matchCase:!0});h.load("items, text, hyperlink"),i.push(h)}else document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Could find text to add ref '+r+" to a bibliography entry.</span></p>"}n[r]=i}return n}function h(e,t,n,r){var o=new Object;for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&Object.prototype.hasOwnProperty.call(r,i)){var a=t.search(n[i].join("").substring(0,255),{matchCase:!0});a.load("items, text"),o[i]=a}return o}function p(e,t,n,r,o){var i=n.hyperlink,c=n.text,u=encodeURI(n.text).replace(/%\w\w/g,(function(e){return e.toLowerCase()}));if(null==i||""==c);else if(i in r&&i!=c){var l=a(t,o[r[i]].label);n.hyperlink=l}else{var s=function(e,t){var n,r="https://hero.epa.gov/hero/index.cfm/reference/details/reference_id/",o="http://heronet.epa.gov/heronet/index.cfm/reference/details/reference_id/";return t.includes(r)||t.includes(o)?("hero"==e&&(n=t.replace(o,r)),"heronet"==e&&(n=t.replace(r,o)),n):null}(t,i);if(null!==s)c!=i&&u!=i||n.insertText(s,"Replace"),n.hyperlink=s;else if(c!=i&&u!=i){var f="info";i.includes("_ENREF_")&&(n.font.highlightColor="#FFFF00",f="err"),"err"!=f&&"true"!=document.getElementById("debug-enabled").value||(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-'+f+'">Hyperlink "'+c+'" ("'+i+'") not changed.</span></p>')}}}function y(e,t,n){var r=new Object,o=[];for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){for(var a=-1,c=n[i].join(""),u=-1,l=0;l<t.length;l++)if(!o.includes(l)){var s=t[l],f=0;if(""!=s.author&&c.includes(s.author)&&(f+=2),""!=s.year&&c.includes(s.year)&&(f+=1),""!=s.title&&c.includes(s.title)&&(f+=4),7==f){a=l,u=f;break}f<4||(-1!=a?f>u&&(a=l,u=f):(a=l,u=f))}-1==a?document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Could not find a matching citation for bib entry "'+c.split(".")[0]+'...".</span></p>':(u<7&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-warn">Matched citation for bib entry "'+c.split(".")[0]+'...", but it was not a full match. Some fields may be missing.</span></p>'),r[i]=a,o.push(a))}return r}function g(e,t){for(var n=new Object,r=t.getElementsByTagName("w:bookmarkStart"),o=0;o<r.length;o++){var i=r[o];if(i.hasAttribute("w:name")){var a=i.getAttribute("w:name");if(a.includes("_ENREF_")){for(var c=i.nextSibling,u=[],l=!0;null!==c;){if("w:r"==c.nodeName&&l){for(var s=c.firstChild;null!==s&&"w:t"!==s.nodeName;)s=s.nextSibling;if(null!==s&&"w:t"==s.nodeName){var f=s.textContent;null!==f&&u.push(f)}}else"w:r"!==c.nodeName&&l&&(l=!1);c=c.nextSibling}0!=u.length&&(n["#"+a]=u)}}}return n}function m(t,n){var r=[],o=[],i=n.querySelectorAll("*|instrText, *|delInstrText"),a=n.getElementsByTagName("w:fldData");null===a&&(a=[]),a.length>0&&r.push(a[0].textContent);for(var c=0,u=1;u<a.length;u++)a[u-1].textContent!=a[u].textContent||c>0?(r.push(a[u].textContent),c=0):c+=1;for(var l=0,s=[],f=!1,d=0;d<i.length;d++){var h,p=i[d].tagName,y=i[d].textContent;h="w:instrText"==p;var g=y.includes("</EndNote>");y.includes(" ADDIN EN.CITE ")&&" ADDIN EN.CITE "!=y?h?g?o.push(y):(f&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-warn">Error parsing split citation, some data may be missing.</span></p>'),f=!0,(s=[]).push(y)):o.push("SKIP"):a.length>0&&" ADDIN EN.CITE.DATA "==y?(h?o.push("DECODE"):o.push("SKIP-DECODE"),l+=1):f&&(s.push(y),g&&(o.push(s.join("")),f=!1,s=[]))}var m=!0;l!=r.length&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Error decoding citations; could not match citations to fields.</span></p>',m=!1);for(var v=[],x=0,E=0;E<o.length;E++){var w;if("DECODE"==o[E]){if(w="",m){var I=r[x].replace("\r","").replace("\n","");I.length>0&&(w=e.Base64.decode(I))}x+=1}else"SKIP"==o[E]?w="":"SKIP-DECODE"==o[E]?(w="",x+=1):w=o[E];w.length>0&&(v=b(0,v,w))}return v}function v(e){return e.replace(/(&quot;|&lt;|&gt;|&amp;|&apos;)/g,(function(e){switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"'}}))}function b(e,t,n){if(!n.includes("<EndNote><Cite"))return t;for(var r=new Object,o=n.split("<Cite"),i=0;i<o.length;i++){var a="",c="",u="",l="",s="",f=o[i].match(/<label>(\d{1,})<\/label>/g);if(f||(f=o[i].match(/<IDText>(\d{1,})<\/IDText>/g)),f)if(1==f.length)u=f[0];else{for(var d=[],h=0;h<f.length;h++)d.includes(f[h])||d.push(f[h]);1==d.length&&(u=d[0])}var p=o[i].match(/<Author>([^<>/]{1,})<\/Author>/),y=o[i].match(/<Author>([^<>/]{1,})<\/Author>/g);p&&y&&1==y.length&&(a=v(p[1]));var g=o[i].match(/<Year>(\d{4})<\/Year>/),m=o[i].match(/<Year>(\d{4})<\/Year>/g);if(g&&m&&1==m.length)c=g[1];else{var b=o[i].match(/<custom7>(In Press)<\/custom7>/),x=o[i].match(/<custom7>(In Press)<\/custom7>/g);b&&x&&1==x.length&&(c=b[1])}var E=o[i].match(/<title>([^<>]{1,})<\/title>/),w=o[i].match(/<title>([^<>]{1,})<\/title>/g);E&&w&&1==w.length&&(l=v(E[1]));var I=o[i].match(/<url>([^<>]{1,})<\/url>/),B=o[i].match(/<url>([^<>]{1,})<\/url>/g);if(I&&B&&1==B.length&&(s=v(I[1])),""!=u){var A=a+c+l;if((u=u.match(/<[a-zA-Z]{5,6}>(\d{1,})<\/[a-zA-Z]{5,6}>/)[1])in r){if(r[u].includes(A))continue;r[u].push(A)}else r[u]=[A];var L={label:u,author:a,year:c,title:l,url:s};t.push(L)}else o[i].includes(" ADDIN EN")||o[i].includes("<EndNote>")||(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">The following citation is missing a HERO ID: "'+a+" "+c+'"</span></p>')}return t}Office.onReady((function(e){e.host===Office.HostType.Word&&(Office.context.requirements.isSetSupported("WordApi","1.3")||(document.getElementById("error-box").innerHTML+="Sorry. LitCiter uses Word.js APIs that are not available in your version of Office.<br/>"),OfficeExtension.config.extendedErrorLogging=!0,document.getElementById("link-hero").onclick=function(){c("hero")},document.getElementById("link-heronet").onclick=function(){c("heronet")},document.getElementById("confirm-box").onclick=function(){1==document.getElementById("confirm-box").checked?(document.getElementById("link-hero").disabled=!1,document.getElementById("link-heronet").disabled=!1):(document.getElementById("link-hero").disabled=!0,document.getElementById("link-heronet").disabled=!0)},document.getElementById("version-text").onclick=function(){"true"==document.getElementById("debug-enabled").value?(document.getElementById("debug-enabled").value="false",document.getElementById("debug-marker").textContent=""):(document.getElementById("debug-enabled").value="true",document.getElementById("debug-marker").textContent=" (debug)")},document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("progress-text").innerHTML="Initializing...")}))}(),function(){"use strict";var e=n(27091),t=n.n(e),r=new URL(n(60806),n.b),o=new URL(n(97574),n.b);t()(r),t()(o)}()}();
//# sourceMappingURL=taskpane.js.map