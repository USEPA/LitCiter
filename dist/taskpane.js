!function(){var e={9666:function(e,t,n){var r,o,i;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g&&n.g,i=function(){"use strict";var e,t="function"==typeof atob,n="function"==typeof btoa,r="function"==typeof Buffer,o="function"==typeof TextDecoder?new TextDecoder:void 0,i="function"==typeof TextEncoder?new TextEncoder:void 0,a=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),c=(e={},a.forEach((function(t,n){return e[t]=n})),e),u=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,l=String.fromCharCode.bind(String),s="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e,t){return void 0===t&&(t=function(e){return e}),new Uint8Array(Array.prototype.slice.call(e,0).map(t))},f=function(e){return e.replace(/=/g,"").replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"}))},d=function(e){return e.replace(/[^A-Za-z0-9\+\/]/g,"")},p=function(e){for(var t,n,r,o,i="",c=e.length%3,u=0;u<e.length;){if((n=e.charCodeAt(u++))>255||(r=e.charCodeAt(u++))>255||(o=e.charCodeAt(u++))>255)throw new TypeError("invalid character found");i+=a[(t=n<<16|r<<8|o)>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}return c?i.slice(0,c-3)+"===".substring(c):i},h=n?function(e){return btoa(e)}:r?function(e){return Buffer.from(e,"binary").toString("base64")}:p,m=r?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],n=0,r=e.length;n<r;n+=4096)t.push(l.apply(null,e.subarray(n,n+4096)));return h(t.join(""))},y=function(e,t){return void 0===t&&(t=!1),t?f(m(e)):m(e)},g=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},b=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,x=function(e){return e.replace(b,g)},v=r?function(e){return Buffer.from(e,"utf8").toString("base64")}:i?function(e){return m(i.encode(e))}:function(e){return h(x(e))},E=function(e,t){return void 0===t&&(t=!1),t?f(v(e)):v(e)},B=function(e){return E(e,!0)},w=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,I=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return l(55296+(t>>>10))+l(56320+(1023&t));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},A=function(e){return e.replace(w,I)},C=function(e){if(e=e.replace(/\s+/g,""),!u.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));for(var t,n,r,o="",i=0;i<e.length;)t=c[e.charAt(i++)]<<18|c[e.charAt(i++)]<<12|(n=c[e.charAt(i++)])<<6|(r=c[e.charAt(i++)]),o+=64===n?l(t>>16&255):64===r?l(t>>16&255,t>>8&255):l(t>>16&255,t>>8&255,255&t);return o},T=t?function(e){return atob(d(e))}:r?function(e){return Buffer.from(e,"base64").toString("binary")}:C,O=r?function(e){return s(Buffer.from(e,"base64"))}:function(e){return s(T(e),(function(e){return e.charCodeAt(0)}))},D=function(e){return O(k(e))},S=r?function(e){return Buffer.from(e,"base64").toString("utf8")}:o?function(e){return o.decode(O(e))}:function(e){return A(T(e))},k=function(e){return d(e.replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})))},j=function(e){return S(k(e))},F=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}},L=function(){var e=function(e,t){return Object.defineProperty(String.prototype,e,F(t))};e("fromBase64",(function(){return j(this)})),e("toBase64",(function(e){return E(this,e)})),e("toBase64URI",(function(){return E(this,!0)})),e("toBase64URL",(function(){return E(this,!0)})),e("toUint8Array",(function(){return D(this)}))},N=function(){var e=function(e,t){return Object.defineProperty(Uint8Array.prototype,e,F(t))};e("toBase64",(function(e){return y(this,e)})),e("toBase64URI",(function(){return y(this,!0)})),e("toBase64URL",(function(){return y(this,!0)}))},H={version:"3.7.2",VERSION:"3.7.2",atob:T,atobPolyfill:C,btoa:h,btoaPolyfill:p,fromBase64:j,toBase64:E,encode:E,encodeURI:B,encodeURL:B,utob:x,btou:A,decode:j,isValid:function(e){if("string"!=typeof e)return!1;var t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:y,toUint8Array:D,extendString:L,extendUint8Array:N,extendBuiltins:function(){L(),N()},Base64:{}};return Object.keys(H).forEach((function(e){return H.Base64[e]=H[e]})),H},"object"===a(t)?e.exports=i():void 0===(o="function"==typeof(r=i)?r.call(t,n,t,e):r)||(e.exports=o)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=n(9666);function t(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function r(e){return function(){var n=this,r=arguments;return new Promise((function(o,i){var a=e.apply(n,r);function c(e){t(a,o,i,c,u,"next",e)}function u(e){t(a,o,i,c,u,"throw",e)}c(void 0)}))}}function o(e,t){var n;return"hero"==e&&(n="https://hero.epa.gov/hero/index.cfm/reference/details/reference_id/"+t),"heronet"==e&&(n="http://heronet.epa.gov/heronet/index.cfm/reference/details/reference_id/"+t),n}function i(e){return a.apply(this,arguments)}function a(){return a=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(n){var r,o,i,a,h,m,y,g,b,x,v,E;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("error-box").innerHTML='<p style="">Errors and Warnings</p>',document.getElementById("loader").style.display="flex",document.getElementById("app-body").style.display="none",document.getElementById("progress-text").innerHTML="Changing links...",r=n.document.body,o=r.getOoxml(),(i=r.getRange("Content").getHyperlinkRanges()).load("items, hyperlink, text, font"),e.next=10,n.sync();case 10:for(a=new DOMParser,x=a.parseFromString(o.value,"text/xml"),y=p(n,x),b=d(0,x),g=f(0,y,b),v=1;v<=i.items.length;v++)E=i.items[v-1],s(0,t,E,g,y);return h=l(0,r,b,g),e.next=19,n.sync();case 19:return m=u(0,h),document.getElementById("progress-text").innerHTML="Adding links to bibliography...",e.next=23,n.sync();case 23:return c(0,t,m,g,y),"Errors and Warnings"==document.getElementById("error-box").textContent&&(document.getElementById("error-box").innerHTML='<p style="">Errors and Warnings: None</p>'),document.getElementById("loader").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("progress-text").innerHTML="",e.next=30,n.sync();case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){document.getElementById("loader").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("error-box").innerHTML+="Fatal error, script exiting...<br/>",document.getElementById("error-box").innerHTML+="Error: "+e+"<br/>",document.getElementById("progress-text").innerHTML="Fatal Error",e instanceof OfficeExtension.Error&&(document.getElementById("error-box").innerHTML+="Debug info: "+JSON.stringify(e.debugInfo)+"<br/>")}));case 2:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}function c(e,t,n,r,i){for(var a in n)if(Object.prototype.hasOwnProperty.call(n,a))for(var c=i[r[a]].label,u=n[a],l=0;l<u.length;l++)for(var s=u[l],f=0;f<s.items.length;f++)s.items[f].hyperlink=o(t,c)}function u(e,t){var n=new Object;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){for(var o=t[r],i=[],a=0;a<o.items.length;a++){for(var c=o.items[a],u=c.text.split("."),l=0,s=0,f=0;f<u.length;f++){var d=u[f];if(d.includes("(")&&(s+=1),d.includes(")")&&(s-=1),l+=d.length,!(d.length<4)){if(d.match(/[(][^)]{4,}[a-z]?[)][.]?/))break;if(f>4)break;if(l>40&&0==s)break}}if(l>0){var p=c.search(u.slice(0,f+1).join("."),{matchCase:!0});p.load("items, text, hyperlink"),i.push(p)}else document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Could find text to add ref '+r+" to a bibliography entry.</span></p>"}n[r]=i}return n}function l(e,t,n,r){var o=new Object;for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&Object.prototype.hasOwnProperty.call(r,i)){var a=t.search(n[i].join("").substring(0,255),{matchCase:!0});a.load("items, text"),o[i]=a}return o}function s(e,t,n,r,i){var a=n.hyperlink,c=n.text,u=encodeURI(n.text).replace(/%\w\w/g,(function(e){return e.toLowerCase()}));if(null==a||""==c);else if(a in r&&a!=c){var l=o(t,i[r[a]].label);n.hyperlink=l}else{var s=function(e,t){var n,r="https://hero.epa.gov/hero/index.cfm/reference/details/reference_id/",o="http://heronet.epa.gov/heronet/index.cfm/reference/details/reference_id/";return t.includes(r)||t.includes(o)?("hero"==e&&(n=t.replace(o,r)),"heronet"==e&&(n=t.replace(r,o)),n):null}(t,a);if(null!==s)c!=a&&u!=a||n.insertText(s,"Replace"),n.hyperlink=s;else if(c!=a&&u!=a){var f="info";a.includes("_ENREF_")&&(n.font.highlightColor="#FFFF00",f="err"),document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-'+f+'">Hyperlink "'+c+'" ("'+a+'") not changed.</span></p>'}}}function f(e,t,n){var r=new Object,o=[];for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){for(var a=-1,c=n[i].join(""),u=-1,l=0;l<t.length;l++)if(!o.includes(l)){var s=t[l],f=0;if(""!=s.author&&c.includes(s.author)&&(f+=2),""!=s.year&&c.includes(s.year)&&(f+=1),""!=s.title&&c.includes(s.title)&&(f+=4),7==f){a=l,u=f;break}f<4||(-1!=a?f>u&&(a=l,u=f):(a=l,u=f))}-1==a?document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Could not find a matching citation for bib entry "'+c.split(".")[0]+'...".</span></p>':(u<7&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-warn">Matched citation for bib entry "'+c.split(".")[0]+'...", but it was not a full match. Some fields may be missing.</span></p>'),r[i]=a,o.push(a))}return r}function d(e,t){for(var n=new Object,r=t.getElementsByTagName("w:bookmarkStart"),o=0;o<r.length;o++){var i=r[o];if(i.hasAttribute("w:name")){var a=i.getAttribute("w:name");if(a.includes("_ENREF_")){for(var c=i.nextSibling,u=[],l=!0;null!==c;){if("w:r"==c.nodeName&&l){for(var s=c.firstChild;null!==s&&"w:t"!==s.nodeName;)s=s.nextSibling;if(null!==s&&"w:t"==s.nodeName){var f=s.textContent;null!==f&&u.push(f)}}else"w:r"!==c.nodeName&&l&&(l=!1);c=c.nextSibling}0!=u.length&&(n["#"+a]=u)}}}return n}function p(t,n){var r=[],o=[],i=n.querySelectorAll("*|instrText, *|delInstrText"),a=n.getElementsByTagName("w:fldData");null===a&&(a=[]),a.length>0&&r.push(a[0].textContent);for(var c=0,u=1;u<a.length;u++)a[u-1].textContent!=a[u].textContent||c>0?(r.push(a[u].textContent),c=0):c+=1;for(var l=0,s=[],f=!1,d=0;d<i.length;d++){var p,h=i[d].tagName,y=i[d].textContent;p="w:instrText"==h;var g=y.includes("</EndNote>");y.includes(" ADDIN EN.CITE ")&&" ADDIN EN.CITE "!=y?p?g?o.push(y):(f&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-warn">Error parsing split citation, some data may be missing.</span></p>'),f=!0,(s=[]).push(y)):o.push("SKIP"):a.length>0&&" ADDIN EN.CITE.DATA "==y?(p?o.push("DECODE"):o.push("SKIP-DECODE"),l+=1):f&&(s.push(y),g&&(o.push(s.join("")),f=!1,s=[]))}var b=!0;l!=r.length&&(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">Error decoding citations; could not match citations to fields.</span></p>',b=!1);for(var x=[],v=0,E=0;E<o.length;E++){var B;if("DECODE"==o[E]){if(B="",b){var w=r[v].replace("\r","").replace("\n","");w.length>0&&(B=e.Base64.decode(w))}v+=1}else"SKIP"==o[E]?B="":"SKIP-DECODE"==o[E]?(B="",v+=1):B=o[E];B.length>0&&(x=m(0,x,B))}return x}function h(e){return e.replace(/(&quot;|&lt;|&gt;|&amp;|&apos;)/g,(function(e){switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"'}}))}function m(e,t,n){if(!n.includes("<EndNote><Cite"))return t;for(var r=new Object,o=n.split("<Cite"),i=0;i<o.length;i++){var a="",c="",u="",l="",s=o[i].match(/<label>(\d{1,})<\/label>/g);if(s||(s=o[i].match(/<IDText>(\d{1,})<\/IDText>/g)),s)if(1==s.length)u=s[0];else{for(var f=[],d=0;d<s.length;d++)f.includes(s[d])||f.push(s[d]);1==f.length&&(u=f[0])}var p=o[i].match(/<Author>([^<>/]{1,})<\/Author>/),m=o[i].match(/<Author>([^<>/]{1,})<\/Author>/g);p&&m&&1==m.length&&(a=h(p[1]));var y=o[i].match(/<Year>(\d{4})<\/Year>/),g=o[i].match(/<Year>(\d{4})<\/Year>/g);if(y&&g&&1==g.length)c=y[1];else{var b=o[i].match(/<custom7>(In Press)<\/custom7>/),x=o[i].match(/<custom7>(In Press)<\/custom7>/g);b&&x&&1==x.length&&(c=b[1])}var v=o[i].match(/<title>([^<>]{1,})<\/title>/),E=o[i].match(/<title>([^<>]{1,})<\/title>/g);if(v&&E&&1==E.length&&(l=h(v[1])),""!=u){var B=a+c+l;if((u=u.match(/<[a-zA-Z]{5,6}>(\d{1,})<\/[a-zA-Z]{5,6}>/)[1])in r){if(r[u].includes(B))continue;r[u].push(B)}else r[u]=[B];var w={label:u,author:a,year:c,title:l};t.push(w)}else o[i].includes(" ADDIN EN")||o[i].includes("<EndNote>")||(document.getElementById("error-box").innerHTML+='<p class="p-warn"><span class="style-err">The following citation is missing a HERO ID: "'+a+" "+c+'"</span></p>')}return t}Office.onReady((function(e){e.host===Office.HostType.Word&&(Office.context.requirements.isSetSupported("WordApi","1.3")||(document.getElementById("error-box").innerHTML+="Sorry. The tutorial add-in uses Word.js APIs that are not available in your version of Office.<br/>"),OfficeExtension.config.extendedErrorLogging=!0,document.getElementById("link-hero").onclick=function(){i("hero")},document.getElementById("link-heronet").onclick=function(){i("heronet")},document.getElementById("confirm-box").onclick=function(){1==document.getElementById("confirm-box").checked?(document.getElementById("link-hero").disabled=!1,document.getElementById("link-heronet").disabled=!1):(document.getElementById("link-hero").disabled=!0,document.getElementById("link-heronet").disabled=!0)},document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("progress-text").innerHTML="Initializing...")}))}()}();
//# sourceMappingURL=taskpane.js.map